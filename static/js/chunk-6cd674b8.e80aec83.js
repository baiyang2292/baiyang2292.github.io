(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6cd674b8"],{"215e":function(t,e,n){"use strict";n.r(e);var i=n("85ea"),o=n("da43"),r=n.n(o),a=new r.a,i={components:{Introduce:i.a},data:function(){return{text:{title:"audioRecorder",main:"音频插件",intro:"",tips:""}}},created:function(){},methods:{start:function(){r.a.getPermission().then(function(){},function(t){}),a.start().then(function(){},function(t){});a.getAnalyseData()}}},n=n("2877"),i=Object(n.a)(i,function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticClass:"flex-bt"},[e("Introduce",{attrs:{text:t.text}}),e("div",{staticClass:"demo-c"},[e("button",{on:{click:t.start}},[t._v("开始录音")]),e("div")])],1)},[],!1,null,"e06bdffe",null);e.default=i.exports},"85ea":function(t,e,n){"use strict";var i={props:{text:{type:Object}}},n=n("2877"),i=Object(n.a)(i,function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticClass:"demo-text"},[e("h3",[t._v(t._s(t.text.title))]),e("p",[t._v("场景概述："+t._s(t.text.main))]),e("p",[t._v("组件简介："+t._s(t.text.intro))]),e("p",[t._v("tips："+t._s(t.text.tips))])])},[],!1,null,null,null);e.a=i.exports},ad9a:function(t,e,n){t.exports=function(n){var i={};function o(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}return o.m=n,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=1)}([function(t,e,n){"use strict";function c(t,e,n){for(var i=0;i<n.length;i++)t.setUint8(e+i,n.charCodeAt(i))}Object.defineProperty(e,"__esModule",{value:!0}),e.compress=function(t,e,n){for(var n=e/n,i=Math.max(n,1),o=t.left,r=t.right,a=Math.floor((o.length+r.length)/n),s=new Float32Array(a),u=0,c=0;u<a;){var l=Math.floor(c);s[u]=o[l],u++,r.length&&(s[u]=r[l],u++),c+=i}return s},e.encodePCM=function(t,e,n){void 0===n&&(n=!0);var i=0,o=t.length*(e/8),o=new ArrayBuffer(o),r=new DataView(o);if(8===e)for(var a=0;a<t.length;a++,i++){var s=(u=Math.max(-1,Math.min(1,t[a])))<0?128*u:127*u;r.setInt8(i,s=+s+128)}else for(a=0;a<t.length;a++,i+=2){var u=Math.max(-1,Math.min(1,t[a]));r.setInt16(i,u<0?32768*u:32767*u,n)}return r},e.encodeWAV=function(t,e,n,i,o,r){void 0===r&&(r=!0);var e=e<n?e:n,n=o,o=new ArrayBuffer(44+t.byteLength),a=new DataView(o),i=i,s=0;c(a,s,"RIFF"),a.setUint32(s+=4,36+t.byteLength,r),c(a,s+=4,"WAVE"),c(a,s+=4,"fmt "),a.setUint32(s+=4,16,r),a.setUint16(s+=4,1,r),a.setUint16(s+=2,i,r),a.setUint32(s+=2,e,r),a.setUint32(s+=4,i*e*(n/8),r),a.setUint16(s+=4,i*(n/8),r),a.setUint16(s+=2,n,r),c(a,s+=2,"data"),a.setUint32(s+=4,t.byteLength,r),s+=4;for(var u=0;u<t.byteLength;)a.setUint8(s,t.getUint8(u)),s++,u++;return a}},function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var r,a=n(2),s=n(0),u=n(3),o=(r=n(5).default,o(c,r),c.prototype.setOption=function(t){this.setNewOption(t=void 0===t?{}:t)},c.prototype.start=function(){return this.isrecording?Promise.reject():(this.isrecording=!0,this.startRecord())},c.prototype.pause=function(){this.isrecording&&!this.ispause&&(this.ispause=!0,this.pauseRecord())},c.prototype.resume=function(){this.isrecording&&this.ispause&&(this.ispause=!1,this.resumeRecord())},c.prototype.stop=function(){this.isrecording&&(this.isrecording=!1,this.ispause=!1,this.stopRecord())},c.prototype.play=function(){this.stop(),this.isplaying=!0,this.onplay&&this.onplay(),u.default.addPlayEnd(this.onplayend);var t=this.getWAV();44<t.byteLength&&u.default.play(t.buffer)},c.prototype.getPlayTime=function(){return u.default.getPlayTime()},c.prototype.pausePlay=function(){!this.isrecording&&this.isplaying&&(this.isplaying=!1,this.onpauseplay&&this.onpauseplay(),u.default.pausePlay())},c.prototype.resumePlay=function(){this.isrecording||this.isplaying||(this.isplaying=!0,this.onresumeplay&&this.onresumeplay(),u.default.resumePlay())},c.prototype.stopPlay=function(){this.isrecording||(this.isplaying=!1,this.onstopplay&&this.onstopplay(),u.default.stopPlay())},c.prototype.destroy=function(){return u.default.destroyPlay(),this.destroyRecord()},c.prototype.getRecordAnalyseData=function(){return this.getAnalyseData()},c.prototype.getPlayAnalyseData=function(){return u.default.getAnalyseData()},c.prototype.getPCM=function(){this.stop();var t=this.getData(),t=s.compress(t,this.inputSampleRate,this.outputSampleRate);return s.encodePCM(t,this.oututSampleBits,this.littleEdian)},c.prototype.getPCMBlob=function(){return new Blob([this.getPCM()])},c.prototype.downloadPCM=function(t){void 0===t&&(t="recorder");var e=this.getPCMBlob();a.downloadPCM(e,t)},c.prototype.getWAV=function(){var t=this.getPCM();return s.encodeWAV(t,this.inputSampleRate,this.outputSampleRate,this.config.numChannels,this.oututSampleBits,this.littleEdian)},c.prototype.getWAVBlob=function(){return new Blob([this.getWAV()],{type:"audio/wav"})},c.prototype.downloadWAV=function(t){void 0===t&&(t="recorder");var e=this.getWAVBlob();a.downloadWAV(e,t)},c.prototype.download=function(t,e,n){a.download(t,e,n)},c.prototype.getChannelData=function(){var t=this.getPCM(),e=t.byteLength,n=this.littleEdian,i={left:null,right:null};if(2===this.config.numChannels){var o=new DataView(new ArrayBuffer(e/2)),r=new DataView(new ArrayBuffer(e/2));if(16===this.config.sampleBits)for(var a=0;a<e/2;a+=2)o.setInt16(a,t.getInt16(2*a,n),n),r.setInt16(a,t.getInt16(2*a+2,n),n);else for(a=0;a<e/2;a+=2)o.setInt8(a,t.getInt8(2*a)),r.setInt8(a,t.getInt8(2*a+1));i.left=o,i.right=r}else i.left=t;return i},c);function c(t){t=r.call(this,t=void 0===t?{}:t)||this;return t.isrecording=!1,t.ispause=!1,t.isplaying=!1,t}e.default=o},function(t,e,n){"use strict";function i(t,e,n){var i=document.createElement("a");i.href=window.URL.createObjectURL(t),i.download=e+"."+n,i.click()}Object.defineProperty(e,"__esModule",{value:!0}),e.downloadWAV=function(t,e){i(t,e=void 0===e?"recorder":e,"wav")},e.downloadPCM=function(t,e){i(t,e=void 0===e?"recorder":e,"pcm")},e.download=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),o=null,r=0,a=0,s=null,u=null,c=null,l=!1,f=0,p=function(){};function d(){return l=!1,s.decodeAudioData(c.slice(0),function(t){(o=s.createBufferSource()).onended=function(){l||(f=s.currentTime-a+r,p())},o.buffer=t,o.connect(u),u.connect(s.destination),o.start(0,r),a=s.currentTime},function(t){i.throwError(t)})}function h(){o&&(o.stop(),o=null)}y.play=function(t){return s||(s=new(window.AudioContext||window.webkitAudioContext),(u=s.createAnalyser()).fftSize=2048),this.stopPlay(),c=t,f=0,d()},y.pausePlay=function(){h(),r+=s.currentTime-a,l=!0},y.resumePlay=d,y.stopPlay=function(){r=0,c=null,h()},y.destroyPlay=function(){this.stopPlay()},y.getAnalyseData=function(){var t=new Uint8Array(u.frequencyBinCount);return u.getByteTimeDomainData(t),t},y.addPlayEnd=function(t){p=t=void 0===t?function(){}:t},y.getPlayTime=function(){var t=l?r:s.currentTime-a+r;return f||t},n=y;function y(){}e.default=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.throwError=function(t){throw new Error(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),n=(o.prototype.setNewOption=function(t){this.config={sampleBits:~[8,16].indexOf((t=void 0===t?{}:t).sampleBits)?t.sampleBits:16,sampleRate:~[8e3,11025,16e3,22050,24e3,44100,48e3].indexOf(t.sampleRate)?t.sampleRate:this.inputSampleRate,numChannels:~[1,2].indexOf(t.numChannels)?t.numChannels:1},this.outputSampleRate=this.config.sampleRate,this.oututSampleBits=this.config.sampleBits},o.prototype.startRecord=function(){var e=this;return this.context&&this.destroyRecord(),this.initRecorder(),navigator.mediaDevices.getUserMedia({audio:!0}).then(function(t){e.audioInput=e.context.createMediaStreamSource(t),e.stream=t}).then(function(){e.audioInput.connect(e.analyser),e.analyser.connect(e.recorder),e.recorder.connect(e.context.destination)})},o.prototype.pauseRecord=function(){this.needRecord=!1},o.prototype.resumeRecord=function(){this.needRecord=!0},o.prototype.stopRecord=function(){this.audioInput&&this.audioInput.disconnect(),this.source&&this.source.stop(),this.recorder.disconnect(),this.analyser.disconnect(),this.needRecord=!0},o.prototype.destroyRecord=function(){return this.clearRecordStatus(),this.stopStream(),this.closeAudioContext()},o.prototype.getAnalyseData=function(){var t=new Uint8Array(this.analyser.frequencyBinCount);return this.analyser.getByteTimeDomainData(t),t},o.prototype.getData=function(){return this.flat()},o.prototype.clearRecordStatus=function(){this.lBuffer.length=0,this.rBuffer.length=0,this.size=0,this.fileSize=0,this.PCM=null,this.audioInput=null,this.duration=0},o.prototype.flat=function(){var t=null,e=new Float32Array(0);1===this.config.numChannels?t=new Float32Array(this.size):(t=new Float32Array(this.size/2),e=new Float32Array(this.size/2));for(var n=0,i=0;i<this.lBuffer.length;i++)t.set(this.lBuffer[i],n),n+=this.lBuffer[i].length;for(i=n=0;i<this.rBuffer.length;i++)e.set(this.rBuffer[i],n),n+=this.rBuffer[i].length;return{left:t,right:e}},o.prototype.initRecorder=function(){var i=this;this.clearRecordStatus(),this.context=new(window.AudioContext||window.webkitAudioContext),this.analyser=this.context.createAnalyser(),this.analyser.fftSize=2048;var t=this.context.createScriptProcessor||this.context.createJavaScriptNode;this.recorder=t.apply(this.context,[4096,this.config.numChannels,this.config.numChannels]),this.recorder.onaudioprocess=function(t){var e,n;i.needRecord&&(e=t.inputBuffer.getChannelData(0),n=null,i.lBuffer.push(new Float32Array(e)),i.size+=e.length,2===i.config.numChannels&&(n=t.inputBuffer.getChannelData(1),i.rBuffer.push(new Float32Array(n)),i.size+=n.length),i.fileSize=Math.floor(i.size/Math.max(i.inputSampleRate/i.outputSampleRate,1))*(i.oututSampleBits/8),e=100*Math.max.apply(Math,e),i.duration+=4096/i.inputSampleRate,i.onprocess&&i.onprocess(i.duration),i.onprogress&&i.onprogress({duration:i.duration,fileSize:i.fileSize,vol:e}))}},o.prototype.stopStream=function(){this.stream&&this.stream.getTracks&&(this.stream.getTracks().forEach(function(t){return t.stop()}),this.stream=null)},o.prototype.closeAudioContext=function(){return this.context&&this.context.close&&"closed"!==this.context.state?this.context.close():new Promise(function(t){t()})},o.initUserMedia=function(){void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(n){var i=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return i?new Promise(function(t,e){i.call(navigator,n,t,e)}):Promise.reject(new Error("浏览器不支持 getUserMedia !"))})},o.prototype.transformIntoPCM=function(t,e){t=new Float32Array(t),e=new Float32Array(e),e=i.compress({left:t,right:e},this.inputSampleRate,this.outputSampleRate);return i.encodePCM(e,this.oututSampleBits,this.littleEdian)},o.getPermission=function(){return this.initUserMedia(),navigator.mediaDevices.getUserMedia({audio:!0}).then(function(t){t&&t.getTracks().forEach(function(t){return t.stop()})})},o);function o(t){void 0===t&&(t={}),this.size=0,this.lBuffer=[],this.rBuffer=[],this.tempPCM=[],this.inputSampleBits=16,this.fileSize=0,this.duration=0,this.needRecord=!0;var e=new(window.AudioContext||window.webkitAudioContext);this.inputSampleRate=e.sampleRate,this.setNewOption(t),this.littleEdian=(t=new ArrayBuffer(2),new DataView(t).setInt16(0,256,!0),256===new Int16Array(t)[0]),o.initUserMedia()}e.default=n}]).default},da43:function(t,e,n){t.exports=n("ad9a")}}]);